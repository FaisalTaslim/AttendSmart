<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin</title>
    <link rel="stylesheet" href="/css/global/theme/light-theme.css">
    <link rel="stylesheet" href="/css/global/ui-components/font-family.css">
    <link rel="stylesheet" href="/css/global/ui-components/scrollbar.css">
    <link rel="stylesheet" href="/css/global/layout/header.css">
    <link rel="stylesheet" href="/css/global/layout/footer.css">
    <link rel="stylesheet" href="/css/global/ui-components/forms.css">
    <link rel="stylesheet" href="/css/global/ui-components/tables.css">
    <link rel="stylesheet" href="/css/global/ui-components/popup.css">
    <link rel="stylesheet" href="/css/page-specific/dashboard/admin.css">

    <script src="https://kit.fontawesome.com/f75c66b724.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>

<body>
    <% if (popupMessage) { %>
        <div id="popup" class="popup <%= popupType %> show">
            <%= popupMessage %>
        </div>
        <% } %>
            <header>
                <div class="logo">
                    <h1 class="mobile-hidden">AttendSmart</h1>
                </div>

                <nav class="nav-bar">
                    <a href="/" class="nav-links-property">Home</a>
                    <a href="/logout" class="nav-links-property">Logout</a>
                    <a href="/guidebook" class="nav-links-property">GuideBook</a>
                </nav>

                <nav class="mobile-nav-container">
                    <div class="nav-select">
                        <select id="mobile-nav">
                            <option value="" disabled selected>-- Navigate --</option>
                            <option value="/">Home</option>
                            <option value="/logout">Logout</option>
                            <option value="/guidebook">GuideBook</option>
                        </select>
                    </div>
                </nav>
            </header>

            <main>
                <div class="main-1 admin-shell">
                    <section class="admin-hero">
                        <div class="hero-content">
                            <p class="hero-tag">Admin Control Center</p>
                            <h1>Manage your organization from one modern dashboard</h1>
                            <p>Everything from setup to reports is grouped below for faster access and cleaner
                                workflows.</p>
                        </div>
                        <div class="hero-status">
                            <% if (type !=='corporate' && (subjectsUpload===false && scheduleUpload===false)) { %>
                                <div id="finish-setup" class="status-badge status-alert">Finish setup</div>
                                <% } else if (type==='corporate' && scheduleUpload===false) { %>
                                    <div id="finish-setup" class="status-badge status-alert">Finish setup</div>
                                    <% } else { %>
                                        <div class="status-badge status-ok">Setup complete</div>
                                        <% } %>
                                            <div class="status-badge">Account: <%= type %>
                                            </div>
                        </div>
                    </section>

                    <section id="dashboard-overview" class="dashboard-overview">
                        <section id="quick-grid" class="quick-grid">
                            <article class="quick-card">
                                <h3>Attendance</h3>
                                <div class="card-links">
                                    <form action="/dashboard/admin/employee/start-session" method="POST">
                                        <button type="submit" class="feature-link">
                                            Start Session
                                        </button>
                                    </form>
                                    <p id="option-edit-attendance" class="feature-link">Edit Attendance</p>
                                    <p id="option-attendance-summary" class="feature-link">Attendance Summary</p>
                                    <p id="option-download-reports" class="feature-link">Download Reports</p>
                                </div>
                            </article>

                            <article class="quick-card">
                                <h3>User Management</h3>
                                <div class="card-links">
                                    <p id="option-view-users" class="feature-link">View Users</p>
                                    <p id="option-add-users" class="feature-link">Add Users</p>
                                    <p id="option-suspend-remove-users" class="feature-link">Suspend / Remove Users</p>
                                    <p id="option-leave-requests" class="feature-link">Leave Requests</p>
                                </div>
                            </article>

                            <article class="quick-card">
                                <h3>Academic Configuration</h3>
                                <div class="card-links">
                                    <p id="option-subjects" class="feature-link">Subjects</p>
                                    <p id="option-schedules" class="feature-link">Schedules</p>
                                    <p id="option-academic-year" class="feature-link">Academic Year</p>
                                </div>
                            </article>

                            <article class="quick-card">
                                <h3>Communication</h3>
                                <div class="card-links">
                                    <p id="option-send-notice" class="feature-link">Send Notice</p>
                                    <p id="option-announcements" class="feature-link">Announcements</p>
                                </div>
                            </article>

                            <article class="quick-card">
                                <h3>Logs & Reports</h3>
                                <div class="card-links">
                                    <p id="option-activity-logs" class="feature-link">Activity Logs</p>
                                    <p id="option-attendance-logs" class="feature-link">Attendance Logs</p>
                                    <p id="option-system-logs" class="feature-link">System Logs</p>
                                </div>
                            </article>

                            <article class="quick-card">
                                <h3>Support</h3>
                                <div class="card-links">
                                    <p id="option-support-requests" class="feature-link">Support Requests</p>
                                    <p id="option-help-guidebook" class="feature-link">Help & Guidebook</p>
                                </div>
                            </article>
                        </section>

                        <section class="setup-uploads">
                            <% if (type !=='corporate' && subjectsUpload===false) { %>
                                <div class="upload-card">
                                    <h2>Complete the setup</h2>
                                    <p>
                                        Read the <a href="/guideboook" class="link">guide</a> before you submit these
                                        csv files.
                                        Also feel free to reach out for <a href="/" class="link">support</a> if you need
                                        any
                                        help.
                                    </p>
                                    <form id="subjectsForm" enctype="multipart/form-data">
                                        <input type="file" id="subjectsCsv" name="subjectsCsv" accept=".csv" hidden>

                                        <label for="subjectsCsv" class="upload-label">
                                            <div class="upload-content">
                                                <div class="upload-icon"><i class="fa-solid fa-file-arrow-up"></i></div>
                                                <p class="upload-title">Upload the subjects CSV file</p>
                                                <p class="upload-subtitle">Only .csv files are supported</p>
                                            </div>
                                        </label>
                                    </form>
                                </div>
                                <% } %>

                                    <% if (scheduleUpload===false) { %>
                                        <div class="upload-card">
                                            <h2>Schedule setup</h2>
                                            <form id="scheduleForm" enctype="multipart/form-data">
                                                <input type="file" id="scheduleCsv" name="scheduleCsv" accept=".csv"
                                                    hidden>

                                                <label for="scheduleCsv" class="upload-label">
                                                    <div class="upload-content">
                                                        <div class="upload-icon"><i
                                                                class="fa-solid fa-calendar-plus"></i></div>
                                                        <p class="upload-title">Upload the schedule CSV file</p>
                                                        <p class="upload-subtitle">Only .csv files are supported</p>
                                                    </div>
                                                </label>
                                            </form>
                                            <p class="tip"><b>Note:</b> You can later make changes in subjects and
                                                schedule list
                                                through settings</p>
                                        </div>
                                        <% } %>
                        </section>
                    </section>

                    <section id="content" class="content" hidden>
                        <button id="go-back" class="go-back" type="button">
                            <i class="fa-solid fa-arrow-left"></i> Go Back
                        </button>

                        <article id="content-edit-attendance" class="content-panel" hidden>
                            <h2>Edit Attendance</h2>
                            <p>Update attendance records for any date, class, and subject from a single workflow.</p>
                        </article>
                        <article id="content-attendance-summary" class="content-panel" hidden>
                            <h2>Attendance Summary</h2>
                            <p>View monthly and daily summaries for students and employees inside your organization.</p>
                        </article>
                        <article id="content-download-reports" class="content-panel" hidden>
                            <h2>Download Reports</h2>
                            <p>Export filtered attendance data into report files for audits and internal use.</p>
                        </article>
                        <article id="content-view-users" class="content-panel" hidden>
                            <h2>View Users</h2>
                            <p>See registered students and employees with organization-level filtering.</p>

                            <div class="users-filter-row">
                                <label for="users-type-filter">User Type</label>
                                <div class="nav-select users-filter-select">
                                    <select id="users-type-filter">
                                        <option value="students" selected>Students</option>
                                        <option value="employees">Employees</option>
                                    </select>
                                </div>
                            </div>

                            <div id="users-table-students" class="users-table-view">
                                <div class="table-scroll">
                                    <table class="users-table">
                                        <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>User Code</th>
                                                <th>Roll</th>
                                                <th>Class / Dept</th>
                                                <th>Email</th>
                                                <th>Contact</th>
                                                <th>Setup Done?</th>
                                                <th>Status</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <% if (student_users && student_users.length) { %>
                                                <% student_users.forEach((student)=> { %>
                                                    <tr>
                                                        <td data-label="Name">
                                                            <%= student.name || '-' %>
                                                        </td>
                                                        <td data-label="User Code">
                                                            <%= student.code || '-' %>
                                                        </td>
                                                        <td data-label="Roll">
                                                            <%= student.roll || '-' %>
                                                        </td>
                                                        <td data-label="Class / Dept">
                                                            <%= student.standard || student.dept || '-' %>
                                                        </td>
                                                        <td data-label="Email">
                                                            <%= student.email || '-' %>
                                                        </td>
                                                        <td data-label="Contact">
                                                            <%= student.contact || '-' %>
                                                        </td>
                                                        <td data-label="Setup Done?">
                                                            <%= student.setup && typeof
                                                                student.setup.faceUploaded==='boolean' ?
                                                                (student.setup.faceUploaded ? 'Yes' : 'No' ) : '-' %>
                                                        </td>
                                                        <td data-label="Status">
                                                            <%= student.isSuspended ? 'Suspended' : (student.isDeleted
                                                                ? 'Deleted' : 'Active' ) %>
                                                        </td>
                                                    </tr>
                                                    <% }) %>
                                                        <% } else { %>
                                                            <tr>
                                                                <td colspan="8">No students found.</td>
                                                            </tr>
                                                            <% } %>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div id="users-table-employees" class="users-table-view" hidden>
                                <div class="table-scroll">
                                    <table class="users-table">
                                        <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>User Code</th>
                                                <th>Employee ID</th>
                                                <th>Designation</th>
                                                <th>Email</th>
                                                <th>Contact</th>
                                                <th>Setup Done?</th>
                                                <th>Status</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <% if (employee_users && employee_users.length) { %>
                                                <% employee_users.forEach((employee)=> { %>
                                                    <tr>
                                                        <td data-label="Name">
                                                            <%= employee.name || '-' %>
                                                        </td>
                                                        <td data-label="User Code">
                                                            <%= employee.code || '-' %>
                                                        </td>
                                                        <td data-label="Employee ID">
                                                            <%= employee.employeeId || '-' %>
                                                        </td>
                                                        <td data-label="Designation">
                                                            <%= employee.designation || '-' %>
                                                        </td>
                                                        <td data-label="Email">
                                                            <%= employee.email || '-' %>
                                                        </td>
                                                        <td data-label="Contact">
                                                            <%= employee.contact || '-' %>
                                                        </td>
                                                        <td data-label="Setup Done?">
                                                            <%= employee.setup && typeof
                                                                employee.setup.faceUploaded==='boolean' ?
                                                                (employee.setup.faceUploaded ? 'Yes' : 'No' ) : '-' %>
                                                        </td>
                                                        <td data-label="Status">
                                                            <%= employee.isSuspended ? 'Suspended' : (employee.isDeleted
                                                                ? 'Deleted' : 'Active' ) %>
                                                        </td>
                                                    </tr>
                                                    <% }) %>
                                                        <% } else { %>
                                                            <tr>
                                                                <td colspan="8">No employees found.</td>
                                                            </tr>
                                                            <% } %>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </article>
                        <article id="content-add-users" class="content-panel content-add-users" hidden>
                            <h2>Add Users</h2>
                            <p>Upload CSV files to add student and employee accounts in bulk.</p>

                            <section class="add-users-grid">
                                <article class="upload-card add-user-card">
                                    <h3>Add Students</h3>
                                    <p>Upload a student list CSV with the required headers and valid organization
                                        details.</p>

                                    <form action="/dashboard/admin/upload-students" method="POST"
                                        id="students-users-form" class="csv-upload-form" enctype="multipart/form-data">
                                        <input type="file" id="students-users-csv" name="studentsUsersCsv" accept=".csv"
                                            hidden>
                                        <label for="students-users-csv" class="upload-label">
                                            <div class="upload-content">
                                                <div class="upload-icon"><i class="fa-solid fa-user-graduate"></i></div>
                                                <p class="upload-title">Upload Students CSV</p>
                                                <p class="upload-subtitle">Only .csv files are supported</p>
                                            </div>
                                        </label>
                                        <button type="submit">Upload</button>
                                    </form>

                                    <p class="tip"><b>Required:</b> Name, roll, class/dept, contact, email, and other
                                        organization-specific fields.</p>
                                    <a href="/guidebook" class="link">Open CSV guide</a>
                                </article>

                                <article class="upload-card add-user-card">
                                    <h3>Add Employees</h3>
                                    <p>Upload an employee list CSV for teaching and non-teaching staff registration.</p>

                                    <form action="/dashboard/admin/upload-employees" method="POST"
                                        id="employees-users-form" class="csv-upload-form" enctype="multipart/form-data">
                                        <input type="file" id="employees-users-csv" name="employeesUsersCsv"
                                            accept=".csv" hidden>
                                        <label for="employees-users-csv" class="upload-label">
                                            <div class="upload-content">
                                                <div class="upload-icon"><i class="fa-solid fa-user-tie"></i></div>
                                                <p class="upload-title">Upload Employees CSV</p>
                                                <p class="upload-subtitle">Only .csv files are supported</p>
                                            </div>
                                        </label>
                                        <button type="submit">Upload</button>
                                    </form>

                                    <p class="tip"><b>Required:</b> Name, employee ID, designation, contact, email, and
                                        shift
                                        details.</p>
                                    <a href="/guidebook" class="link">Open CSV guide</a>
                                </article>
                            </section>
                        </article>
                        <article id="content-suspend-remove-users" class="content-panel" hidden>
                            <h2>Suspend / Remove Users</h2>
                            <p>Find users quickly and take account actions from one place.</p>

                            <section class="manage-users-panel">
                                <div class="manage-users-controls">
                                    <div class="manage-users-control">
                                        <label for="manage-users-type">User Type</label>
                                        <div class="nav-select users-filter-select">
                                            <select id="manage-users-type">
                                                <option value="students" selected>Students</option>
                                                <option value="employees">Employees</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="manage-users-control">
                                        <label for="manage-users-search">Search Users</label>
                                        <input type="text" id="manage-users-search"
                                            placeholder="Search by name, code, email, roll or employee ID">
                                    </div>
                                </div>

                                <div id="manage-students-wrap" class="users-table-view">
                                    <div class="table-scroll">
                                        <table class="users-table manage-users-table">
                                            <thead>
                                                <tr>
                                                    <th>Name</th>
                                                    <th>User Code</th>
                                                    <th>Roll</th>
                                                    <th>Dept</th>
                                                    <th>Email</th>
                                                    <th>Status</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% if (student_users && student_users.length) { %>
                                                    <% student_users.forEach((student)=> { %>
                                                        <tr class="manage-student-row">
                                                            <td data-label="Name" class="manage-student-name">
                                                                <%= student.name || '-' %>
                                                            </td>
                                                            <td data-label="User Code" class="manage-student-code">
                                                                <%= student.code || '-' %>
                                                            </td>
                                                            <td data-label="Roll" class="manage-student-roll">
                                                                <%= student.roll || '-' %>
                                                            </td>
                                                            <td data-label="Dept">
                                                                <%= student.standard || student.dept || '-' %>
                                                            </td>
                                                            <td data-label="Email" class="manage-student-email">
                                                                <%= student.email || '-' %>
                                                            </td>
                                                            <td data-label="Status">
                                                                <% if (student.isDeleted) { %>
                                                                    <span
                                                                        class="manage-status-chip deleted">Deleted</span>
                                                                    <% } else if (student.isSuspended) { %>
                                                                        <span
                                                                            class="manage-status-chip suspended">Suspended</span>
                                                                        <% } else { %>
                                                                            <span
                                                                                class="manage-status-chip active">Active</span>
                                                                            <% } %>
                                                            </td>
                                                            <td data-label="Actions" class="manage-actions-cell">
                                                                <form
                                                                    action="/dashboard/admin/users/student/suspend/<%= student.code %>"
                                                                    method="POST">
                                                                    <button type="submit"
                                                                        class="manage-action-btn suspend-user-btn">Suspend</button>
                                                                </form>
                                                                <form
                                                                    action="/dashboard/admin/users/student/remove/<%= student.code %>"
                                                                    method="POST">
                                                                    <button type="button"
                                                                        class="manage-action-btn remove-user-btn">Remove
                                                                    </button>
                                                                </form>
                                                            </td>
                                                        </tr>
                                                        <% }) %>
                                                            <% } else { %>
                                                                <tr>
                                                                    <td colspan="7">No students found.</td>
                                                                </tr>
                                                                <% } %>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div id="manage-employees-wrap" class="users-table-view" hidden>
                                    <div class="table-scroll">
                                        <table class="users-table manage-users-table">
                                            <thead>
                                                <tr>
                                                    <th>Name</th>
                                                    <th>User Code</th>
                                                    <th>Employee ID</th>
                                                    <th>Designation</th>
                                                    <th>Email</th>
                                                    <th>Status</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% if (employee_users && employee_users.length) { %>
                                                    <% employee_users.forEach((employee)=> { %>
                                                        <tr class="manage-employee-row">
                                                            <td data-label="Name" class="manage-employee-name">
                                                                <%= employee.name || '-' %>
                                                            </td>
                                                            <td data-label="User Code" class="manage-employee-code">
                                                                <%= employee.code || '-' %>
                                                            </td>
                                                            <td data-label="Employee ID" class="manage-employee-id">
                                                                <%= employee.employeeId || '-' %>
                                                            </td>
                                                            <td data-label="Designation"
                                                                class="manage-employee-designation">
                                                                <%= employee.designation || '-' %>
                                                            </td>
                                                            <td data-label="Email" class="manage-employee-email">
                                                                <%= employee.email || '-' %>
                                                            </td>
                                                            <td data-label="Status">
                                                                <% if (employee.isDeleted) { %>
                                                                    <span
                                                                        class="manage-status-chip deleted">Deleted</span>
                                                                    <% } else if (employee.isSuspended) { %>
                                                                        <span
                                                                            class="manage-status-chip suspended">Suspended</span>
                                                                        <% } else { %>
                                                                            <span
                                                                                class="manage-status-chip active">Active</span>
                                                                            <% } %>
                                                            </td>
                                                            <td data-label="Actions" class="manage-actions-cell">
                                                                <form
                                                                    action="/dashboard/admin/users/employee/suspend/<%= employee.code %>"
                                                                    method="POST">
                                                                    <button type="submit"
                                                                        class="manage-action-btn suspend-user-btn">Suspend</button>
                                                                </form>
                                                                <form
                                                                    action="/dashboard/admin/users/employee/remove/<%= employee.code %>"
                                                                    method="POST">
                                                                    <button type="button"
                                                                        class="manage-action-btn remove-user-btn">Remove
                                                                    </button>
                                                                </form>
                                                            </td>
                                                        </tr>
                                                        <% }) %>
                                                            <% } else { %>
                                                                <tr>
                                                                    <td colspan="7">No employees found.</td>
                                                                </tr>
                                                                <% } %>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </section>
                        </article>
                        <article id="content-leave-requests" class="content-panel" hidden>
                            <h2>Leave Requests</h2>
                            <p>Review incoming leave requests and approve or reject them quickly.</p>
                        </article>
                        <article id="content-subjects" class="content-panel" hidden>
                            <h2>Subjects</h2>
                            <p>Maintain your subject list and keep mapping clean for attendance sessions.</p>
                        </article>
                        <article id="content-schedules" class="content-panel" hidden>
                            <h2>Schedules</h2>
                            <p>Manage class and department schedules used in daily attendance capture.</p>
                        </article>
                        <article id="content-academic-year" class="content-panel" hidden>
                            <h2>Academic Year</h2>
                            <p>Configure active academic year and apply it across relevant modules.</p>
                        </article>
                        <article id="content-send-notice" class="content-panel" hidden>
                            <h2>Send Notice</h2>
                            <p>Send structured notices to students, employees, or selected groups.</p>
                        </article>
                        <article id="content-announcements" class="content-panel" hidden>
                            <h2>Announcements</h2>
                            <p>Publish organization-wide updates for important events and schedules.</p>
                        </article>
                        <article id="content-activity-logs" class="content-panel" hidden>
                            <h2>Activity Logs</h2>
                            <p>Track account and dashboard actions for transparency and troubleshooting.</p>
                        </article>
                        <article id="content-attendance-logs" class="content-panel" hidden>
                            <h2>Attendance Logs</h2>
                            <p>Inspect detailed check-in history and validation status in one place.</p>
                        </article>
                        <article id="content-system-logs" class="content-panel" hidden>
                            <h2>System Logs</h2>
                            <p>Review technical logs related to setup, uploads, and key system actions.</p>
                        </article>
                        <article id="content-support-requests" class="content-panel" hidden>
                            <h2>Support Requests</h2>
                            <p>View open support tickets and keep communication organized.</p>
                        </article>
                        <article id="content-help-guidebook" class="content-panel" hidden>
                            <h2>Help & Guidebook</h2>
                            <p>Access guides and setup references for smoother admin operations.</p>
                        </article>
                    </section>
                </div>
            </main>

            <footer>
                <div class="foot-content">
                    <div class="foot1">
                        <div class="useful-links">
                            <p><strong>Useful-links</strong></p>
                            <a href="#register" class="links foot-links" target="_blank">Register</a>
                            <a href="#support-forms" class="links foot-links" target="_blank">Support</a>
                        </div>
                        <div class="legal">
                            <p><strong>Legal</strong></p>
                            <a href="#" class="links foot-links" target="_blank">Terms & conditions</a>
                            <a href="#" class="links foot-links" target="_blank">Privacy Policy</a>
                            <a href="#" class="links foot-links" target="_blank">Refund Policy</a>
                        </div>
                    </div>
                    <div class="foot2">
                        <div class="socials">
                            <p><strong>Socials</strong></p>
                            <a href="#" class="links foot-links" target="_blank">
                                <i class="fa-brands fa-instagram"></i> | @faisal_9542
                            </a>
                            <a href="#" class="links foot-links" target="_blank">
                                <i class="fa-brands fa-discord"></i> | @famaeoxiaa
                            </a>
                            <a href="#" class="links foot-links" target="_blank">
                                <i class="fa-brands fa-github"></i> | @FaisalTaslim
                            </a>
                        </div>
                        <div class="contacts">
                            <p><strong>Contacts</strong></p>
                            <p><i class="fa-solid fa-phone"></i> | +91 7449925137 </p>
                            <p><i class="fa-solid fa-envelope"></i> | mailto: faisaltaslim79@gmail.com</p>
                        </div>
                    </div>
                </div>
            </footer>

            <script src="/js/global/UI/rearrange-footer.js"></script>
            <script src="/js/page-specific/dashboard/admin/upload-csv.js"></script>
            <script src="/js/page-specific/dashboard/admin/navigate-contents.js"></script>
            <script src="/js/page-specific/dashboard/admin/view-users.js"></script>
            <script src="/js/page-specific/dashboard/admin/manage-users.js"></script>
            <script src="/js/global/UI/popup.js"></script>
</body>

</html>